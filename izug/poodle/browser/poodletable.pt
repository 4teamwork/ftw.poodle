<div tal:define="uid python:options['uid'];
                 context python:context.archetype_tool.getObject(uid)"
     tal:attributes="id string:poodltablewrapper_${context/UID}" i18n:domain="izug.poodle">

<form action="" method="post" id="poodleForm">
  <table tal:attributes="id string:poodletable_${context/UID}" class="poodletable listing" metal:define-macro="poodle_listingy"
         tal:define="poodledata context/getPoodleData;
                     users context/getUsers;
                     dates context/getDates;
                     member here/@@plone_portal_state/member">
      <tr>
          <th></th>
          <th tal:repeat="date dates" tal:content="string:${date/date} - ${date/duration}"/>
      </tr>
      <tr tal:repeat="user users">
          <tal:block define="currentUser python:view.isCurrentUser(user)">
              <td tal:content="python:view.getUserFullname(user)"/>
              <tal:block repeat="date dates">
                  <td tal:define="userdata python: poodledata[user][date.get('date')];
                                  cssclass python: view.getCssClass(userdata);
                                  inputid python: view.getInputId(user, date)"
                      tal:attributes="class cssclass">
                      <tal:if condition="currentUser">
                          <input type="checkbox"
                                 checked="checked"
                                 tal:condition="userdata"
                                 tal:attributes="name inputid;
                                                 value python:date['date'];"/>
                          <input type="checkbox"
                                 tal:condition="not:userdata"
                                 tal:attributes="name inputid;
                                                 value python:date['date'];"/>
                      </tal:if>
                      <tal:if condition="not:currentUser">
                           <span tal:condition="python: userdata == True"
                                 tal:content="string:âˆš"/>
                           <span tal:condition="python: userdata == False"
                                 tal:content="string:"/>
                           <span tal:condition="python: userdata == None"
                                 tal:content="string:"/>
                      
                      </tal:if>
                  </td>
              </tal:block>
          </tal:block>
      </tr>
      <tr>
            <td i18n:translate="">
                Results
            </td>
            <td tal:replace="structure python:view.poodleResults(data=poodledata)"> 
                poodle results
            </td>
      </tr>
      <tr class="DefineMeetingRow" tal:condition="python:member.has_role('Owner',here)">
        <th>&nbsp;</th>
        <th class="buttonContainer" tal:repeat="date dates">
            <form action="" name="subform">
                <input type="submit" name="subform.submit.button" value="Termin w&auml;hlen" />
                <input type="text" name="date_from" tal:attributes="value date/date" style="display:none"/>
                <input type="text" name="date_time" tal:attributes="value date/duration" style="display:none"/>
                <input type="text" name="poodle_uid" tal:attributes="value context/UID" style="display:none"/>
            </form>
        </th>
      
      </tr>
  </table>
  <input type="text" name="uid" tal:attributes="value string:${context/UID}" style="display:none" />          
  <input class="context allowMultiSubmit"
         tal:attributes="id string:uid_${context/UID}" type="submit" value="Save" i18n:attributes="value izugpoodle_title_save;" name="form.button.Save"/>
  <input class="standalone allowMultiSubmit" type="submit" value="Cancel"  i18n:attributes="value izugpoodle_title_cancel;" name="form.button.Cancel"/>
</form>
</div>


